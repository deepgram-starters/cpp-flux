[meta]
title = "C++ Flux Starter"
description = "Get started using Deepgram's Flux API for real-time transcription with turn detection using this C++ demo app"
author = "Deepgram DX Team <devrel@deepgram.com> (https://developers.deepgram.com)"
repository = "https://github.com/deepgram-starters/cpp-flux"
useCase = "flux"
language = "cpp"
framework = "Crow"
sdk = "N/A"
tags = ["flux", "turn-detection", "real-time-transcription", "streaming-stt", "end-of-turn", "cpp", "crow", "boost-beast"]

[check]
command = ["command -v git", "command -v cmake", "command -v make"]
message = "Prerequisites checked"

[install.pre]
command = "git submodule update --init --recursive"
message = "Submodules initialized"

[install]
command = ["cmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=$VCPKG_ROOT/scripts/buildsystems/vcpkg.cmake", "cmake --build build --parallel"]
message = "Dependencies installed and project built"

[install.config]
sample = "sample.env"
output = ".env"

[start.pre]
command = ["test -f .env || echo 'Error: .env file not found'", "test -d frontend/.git || echo 'Error: Frontend submodule not initialized'"]
message = "Pre-flight checks complete"

[start]
command = ["./build/cpp-flux", "cd frontend && pnpm run dev -- --port 8080 --no-open"]
parallel = true
message = "Application running on http://localhost:8080"

[update]
command = "git submodule update --remote --merge"
message = "Submodules updated"

[clean]
command = ["rm -rf build", "rm -rf vcpkg_installed", "rm -rf frontend/node_modules", "rm -rf frontend/dist"]
message = "Build artifacts cleaned"

# Eject frontend and contracts submodules for standalone development
[eject-frontend]
command = "make eject-frontend"
message = "Frontend ejected successfully"

[test]
command = "bash contracts/tests/run-flux-app.sh"
message = "Contract conformance tests"
